; PlatformIO Project Configuration File
; BigDashVesc - VESC Dashboard for M5Stack Tab5
;
; Build options: build flags, source filter
; Upload options: custom upload port, speed and extra flags
; Library options: dependencies, extra library storages
; Advanced options: extra scripting

[env:esp32p4_pioarduino]
platform = https://github.com/pioarduino/platform-espressif32.git#54.03.21
upload_speed = 1500000
monitor_speed = 115200
build_type = debug
framework = arduino
board = esp32-p4-evboard
board_build.mcu = esp32p4
board_build.flash_mode = qio

; Pre-build scripts to fix toolchain PATH and prepare build
extra_scripts =
    pre:scripts/add_toolchain_path.py
    pre:scripts/pre_build.py

; Partition table with LittleFS
board_build.partitions = partitions.csv
board_build.filesystem = littlefs

build_flags =
    -DBOARD_HAS_PSRAM
    -DCORE_DEBUG_LEVEL=3
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1
    ; AsyncWebServer configuration
    -DCONFIG_ASYNC_TCP_RUNNING_CORE=1
    -DCONFIG_ASYNC_TCP_USE_WDT=0

lib_deps =
    https://github.com/M5Stack/M5Unified.git
    https://github.com/M5Stack/M5GFX.git
    mathieucarbou/ESPAsyncWebServer@^3.4.5
    bblanchon/ArduinoJson@^7.0.0
